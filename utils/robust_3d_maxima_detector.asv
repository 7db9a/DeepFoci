function [img] = robust_3d_maxima_detector(img,dil,h,t)

    s = imdilate(s,sphere([30,30,10]));
    M = imregionalmax(s);
    c = regionprops(M,'centroid');
    c = round(cat(1, c.Centroid));
    M = false(size(s));
    M(sub2ind(size(M),c(:,2),c(:,1),c(:,3))) = 1;
    imshow(max(M,[],3),[])


end

